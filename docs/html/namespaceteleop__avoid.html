<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RT2-assignment1: teleop_avoid Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">RT2-assignment1
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">A ros-package for the interaction with a mobile robot</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">teleop_avoid Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classteleop__avoid_1_1bcolors.html">bcolors</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classteleop__avoid_1_1_publish_thread.html">PublishThread</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae8346548ca971192cb148f53370b059f"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceteleop__avoid.html#ae8346548ca971192cb148f53370b059f">getKey</a> (key_timeout)</td></tr>
<tr class="separator:ae8346548ca971192cb148f53370b059f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad848ff43d066e30b9f9262e020ab2d87"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceteleop__avoid.html#ad848ff43d066e30b9f9262e020ab2d87">clbk_laser</a> (<a class="el" href="namespaceteleop__avoid.html#a72c00f05811492f6c41512d498042d3f">msg</a>)</td></tr>
<tr class="separator:ad848ff43d066e30b9f9262e020ab2d87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a580cbf1dac188a7b7c099b3de9e09d84"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceteleop__avoid.html#a580cbf1dac188a7b7c099b3de9e09d84">pop_dict</a> (dictionary)</td></tr>
<tr class="separator:a580cbf1dac188a7b7c099b3de9e09d84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ef8e3109c71bab27b9cc6b42b3ac833"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceteleop__avoid.html#a3ef8e3109c71bab27b9cc6b42b3ac833">vels</a> (speed, turn)</td></tr>
<tr class="separator:a3ef8e3109c71bab27b9cc6b42b3ac833"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fba07555c2a7d13551b4c247c9e80e9"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceteleop__avoid.html#a6fba07555c2a7d13551b4c247c9e80e9">main</a> ()</td></tr>
<tr class="separator:a6fba07555c2a7d13551b4c247c9e80e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a72c00f05811492f6c41512d498042d3f"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceteleop__avoid.html#a72c00f05811492f6c41512d498042d3f">msg</a></td></tr>
<tr class="separator:a72c00f05811492f6c41512d498042d3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91891811e0623815f4a47644d267f1da"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceteleop__avoid.html#a91891811e0623815f4a47644d267f1da">ok_left</a> = True</td></tr>
<tr class="separator:a91891811e0623815f4a47644d267f1da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6e11ca462c28bc78ae1fe357cea97e6"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceteleop__avoid.html#ae6e11ca462c28bc78ae1fe357cea97e6">ok_right</a> = True</td></tr>
<tr class="separator:ae6e11ca462c28bc78ae1fe357cea97e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a623ae3ab2eeb592150cf27a5e19b4def"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceteleop__avoid.html#a623ae3ab2eeb592150cf27a5e19b4def">ok_straight</a> = True</td></tr>
<tr class="separator:a623ae3ab2eeb592150cf27a5e19b4def"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4b593015d9c416d27df92a9448582f5"><td class="memItemLeft" align="right" valign="top">dictionary&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceteleop__avoid.html#aa4b593015d9c416d27df92a9448582f5">moveBindings</a></td></tr>
<tr class="separator:aa4b593015d9c416d27df92a9448582f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a749620507f44129f27c71be762af4dc3"><td class="memItemLeft" align="right" valign="top">dictionary&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceteleop__avoid.html#a749620507f44129f27c71be762af4dc3">speedBindings</a></td></tr>
<tr class="separator:a749620507f44129f27c71be762af4dc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">.. module:: teleop_avoid
    :platform: Unix
    :synopsis: Python module for controlling the robot using the keyboard assisted by an obstacle avoidance algorithm
.. moduleauthor:: Mattia Piras &lt;pirasmattia2299@gmail.com&gt;
Subscribes to:
    /scan
Publishes to:
    /cmd_vel
This is the Third Controlling Modality.
Reads inputs from the keyboard and makes the robot navigate in the environment with an obstacle avoidance algorithm. 
Messages of type Twist() are published to the '/cmd_vel' topic. 
The functionality is quite similar to the teleop_twist_keyboad's one. 
</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="ad848ff43d066e30b9f9262e020ab2d87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad848ff43d066e30b9f9262e020ab2d87">&#9670;&nbsp;</a></span>clbk_laser()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def teleop_avoid.clbk_laser </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This callback function is for detecting the obstacles from laser scan information. 
This subscription allowed me to detect the obstacles in the simulation environment but also their position with 
respect to the robot by slicing the LaserScan array in three parts: front, left and right direction. 
* If no obstacles are detected on the right of the robot the variable ``ok_right`` is set to True, otherwise to False.
* If no obstacles are detected on the left of the robot the variable ``ok_left`` is set to True, otherwise to False.
* If no obstacles are detected in front of the robot the variable ``ok_straight`` is set to True, otherwise to False.
Args:
    msg: sensor_msgs/LaserScan.msg, scan from a planar laser range-finder. 
No Returns. 
</pre> 
</div>
</div>
<a id="ae8346548ca971192cb148f53370b059f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8346548ca971192cb148f53370b059f">&#9670;&nbsp;</a></span>getKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def teleop_avoid.getKey </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>key_timeout</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6fba07555c2a7d13551b4c247c9e80e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6fba07555c2a7d13551b4c247c9e80e9">&#9670;&nbsp;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def teleop_avoid.main </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">In the ``main()`` function I made some other changes from the ``teleop_twist_keyboard`` code, that are:
    * Insertion of an if(active == 3) statement in order to block the code when another modality is running.
    * The keys now must be kept pressed in order to move the robot. I did this by setting the key_timeout variable to 0.1. Such variable was the select() timeout. That means that the select() function waits 0.1 seconds for new inputs at every loop
    * Added the above descripted functions: ``clbk_laser`` and ``pop_dict``
</pre> 
</div>
</div>
<a id="a580cbf1dac188a7b7c099b3de9e09d84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a580cbf1dac188a7b7c099b3de9e09d84">&#9670;&nbsp;</a></span>pop_dict()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def teleop_avoid.pop_dict </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dictionary</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">The obstacle avoidance algorithm is based on the modification of the Dictionary for the allowed movements.
Such collision avoidance algorithm just uses the ``.pop(key)`` method that removes and returns the element idexed by key of the dictionary. 
When an obstacle is detected, thanks to the ``/scan`` subscription we also know its direction with respect to the robot, and
this function just pops the index of such direction from the dictionary. In this way the obsatcle
direction is no more allowed and it will be impossible to publish on the /cmd_vel in that direction. 
The ``.pop(key)`` methos is applied by considering all the combinations that the robot could face. 
Args:
    dictionary (dict): allowed movements dictionary
No Returns
</pre> 
</div>
</div>
<a id="a3ef8e3109c71bab27b9cc6b42b3ac833"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ef8e3109c71bab27b9cc6b42b3ac833">&#9670;&nbsp;</a></span>vels()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def teleop_avoid.vels </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>speed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>turn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="aa4b593015d9c416d27df92a9448582f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4b593015d9c416d27df92a9448582f5">&#9670;&nbsp;</a></span>moveBindings</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dictionary teleop_avoid.moveBindings</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;=  {</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        <span class="stringliteral">&#39;i&#39;</span>:(1,0,0,0),</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        <span class="stringliteral">&#39;j&#39;</span>:(0,0,0,1),</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        <span class="stringliteral">&#39;l&#39;</span>:(0,0,0,-1),</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;        <span class="stringliteral">&#39;k&#39;</span>:(-1,0,0,0),</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a72c00f05811492f6c41512d498042d3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72c00f05811492f6c41512d498042d3f">&#9670;&nbsp;</a></span>msg</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string teleop_avoid.msg</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;=  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="stringliteral">&quot;&quot;&quot;</span> + bcolors.BOLD +<span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="stringliteral">Reading from the keyboard and Publishing to Twist!</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="stringliteral">---------------------------</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="stringliteral">&quot;&quot;&quot;</span> + bcolors.ENDC + bcolors.OKBLUE + bcolors.BOLD + <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="stringliteral">[i] go straight    </span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="stringliteral">[j] turn left</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="stringliteral">[l] turn right</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="stringliteral">[k] go backwards</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="stringliteral">&quot;&quot;&quot;</span> + bcolors.HEADER + bcolors.BOLD +<span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="stringliteral">[q]/[z] : increase/decrease max speeds by 10%</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="stringliteral">[w]/[x] : increase/decrease only linear speed by 10%</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="stringliteral">[e]/[c] : increase/decrease only angular speed by 10%</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="stringliteral">&quot;&quot;&quot;</span> + bcolors.ENDC + <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="stringliteral">&quot;&quot;&quot;</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a91891811e0623815f4a47644d267f1da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91891811e0623815f4a47644d267f1da">&#9670;&nbsp;</a></span>ok_left</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool teleop_avoid.ok_left = True</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae6e11ca462c28bc78ae1fe357cea97e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6e11ca462c28bc78ae1fe357cea97e6">&#9670;&nbsp;</a></span>ok_right</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool teleop_avoid.ok_right = True</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a623ae3ab2eeb592150cf27a5e19b4def"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a623ae3ab2eeb592150cf27a5e19b4def">&#9670;&nbsp;</a></span>ok_straight</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool teleop_avoid.ok_straight = True</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a749620507f44129f27c71be762af4dc3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a749620507f44129f27c71be762af4dc3">&#9670;&nbsp;</a></span>speedBindings</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dictionary teleop_avoid.speedBindings</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;= {</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        <span class="stringliteral">&#39;q&#39;</span>:(1.1,1.1),</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        <span class="stringliteral">&#39;z&#39;</span>:(.9,.9),</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        <span class="stringliteral">&#39;w&#39;</span>:(1.1,1),</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;        <span class="stringliteral">&#39;x&#39;</span>:(.9,1),</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;        <span class="stringliteral">&#39;e&#39;</span>:(1,1.1),</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;        <span class="stringliteral">&#39;c&#39;</span>:(1,.9),</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
